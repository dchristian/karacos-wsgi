/*
* Aloha Editor
* Author & Copyright (c) 2010 Gentics Software GmbH
* aloha-sales@gentics.com
* Licensed unter the terms of http://www.aloha-editor.com/license.html
*/
if(!GENTICS.Aloha.Repositories){GENTICS.Aloha.Repositories={}}GENTICS.Aloha.Repositories.LinkList=new GENTICS.Aloha.Repository("com.gentics.aloha.repositories.LinkList");GENTICS.Aloha.Repositories.LinkList.settings.data=[{id:1,name:"Aloha Editor - The HTML5 Editor",url:"http://aloha-editor.com",objectType:"website"}];GENTICS.Aloha.Repositories.LinkList.folder=[];GENTICS.Aloha.Repositories.LinkList.init=function(){for(var i=0;i<this.settings.data.length;i++){var u=this.settings.data[i].uri=this.parseUri(this.settings.data[i].url);this.addFolder("",u.host);var path="/"+u.host;var pathparts=u.path.split("/");for(j=0;j<pathparts.length;j++){if(pathparts[j]&&pathparts[j].lastIndexOf(".")<0){this.addFolder(path,pathparts[j]);path+="/"+pathparts[j]}}this.settings.data[i].parentId=path}};GENTICS.Aloha.Repositories.LinkList.addFolder=function(path,name){var p=path+"/"+name;if(name&&!this.folder[p]){this.folder[p]={id:p,displayName:(name)?name:p,parentId:path,objectType:"host",repositoryId:this.repositoryId}}};GENTICS.Aloha.Repositories.LinkList.query=function(queryString,objectTypeFilter,filter,inFolderId,orderBy,maxItems,skipCount,renditionFilter,callback){var d=this.settings.data.filter(function(e,i,a){var r=new RegExp(queryString,"i");return(jQuery.inArray(e.objectType,objectTypeFilter)>-1&&(e.displayName.match(r)||e.url.match(r)))});callback.call(this,d)};GENTICS.Aloha.Repositories.LinkList.getChildren=function(objectTypeFilter,filter,inFolderId,inTreeId,orderBy,maxItems,skipCount,renditionFilter,callback){var d=[];for(e in this.folder){var l=this.folder[e].parentId;if(typeof this.folder[e]!="function"&&(this.folder[e].parentId==inFolderId||(!this.folder[e].parentId&&inFolderId==this.repositoryId))){d.push(this.folder[e])}}callback.call(this,d)};GENTICS.Aloha.Repositories.LinkList.parseUri=function(str){var o={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][$1]=$2}});return uri};